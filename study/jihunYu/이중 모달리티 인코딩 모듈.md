# 프롬프트
> 이중 모달리티 인코딩이 무엇인지 알려줘

TimeCMA 논문에서 이중 모달리티 인코딩(Dual-Modality Encoding) 모듈은 동일한 시계열 데이터를 두 가지의 서로 다른 방식으로 처리하여, 각각의 장점을 가진 두 종류의 결과물(임베딩)을 만들어내는 부분입니다.

## 두 개의 전문 인코딩 브랜치
이 모듈은 목적이 다른 두 개의 브랜치(branch)로 구성되어 있습니다.

### 1. 시계열 인코딩 브랜치 🧠

역할: 순수한 시계열 데이터를 직접 분석하여 시간적 패턴을 찾아냅니다.


처리 방식: 각 변수의 전체 시계열을 하나의 토큰으로 취급하는 '역 임베딩(inverted embedding)' 방식을 사용하고, 이를 시계열 인코더(Transformer)로 처리합니다.



결과물: '분리되었지만 약한(disentangled yet weak)' 임베딩을 생성합니다. 여기서 '분리되었다'는 것은 텍스트 같은 다른 정보의 방해 없이 순수한 시계열 패턴만 담았다는 의미이고, '약하다'는 것은 LLM처럼 방대한 사전 지식이 없어 정보의 깊이가 얕다는 뜻입니다.

### 2. LLM 기반 인코딩 브랜치 📚

역할: 시계열 데이터를 텍스트 설명과 함께 LLM에 입력하여, LLM의 방대한 사전 지식을 활용한 강력한 정보를 추출합니다.


처리 방식: 시계열 데이터를 "어떤 기간 동안 값은 이러했고, 전체적인 추세는 얼마였다"와 같은 텍스트 프롬프트(prompt)로 감싸 고정된(frozen) GPT-2 모델에 입력합니다. 계산 효율을 위해, 모든 정보를 요약하도록 설계된 프롬프트의 


마지막 토큰 임베딩만을 사용합니다.


결과물: '얽혔지만 강력한(entangled yet robust)' 임베딩을 생성합니다. 여기서 '얽혔다'는 것은 시계열 정보와 텍스트 정보가 뒤섞여 있다는 의미(데이터 얽힘)이고, '강력하다'는 것은 LLM의 사전 학습된 지식 덕분에 정보가 풍부하고 견고하다는 뜻입니다.

## 왜 두 가지 방식이 필요한가?
이처럼 두 가지 방식으로 데이터를 처리하는 이유는 각 결과물의 장점만을 취하기 위해서입니다.

시계열 브랜치의 '깨끗하고 분리된' 특성을 이용해, LLM 브랜치의 '강력하지만 얽혀있는' 결과물 속에서 텍스트 노이즈를 걸러내고 순수한 시계열 정보만 쏙 뽑아내게 됩니다. 이 과정을 통해 최종적으로 

'분리되면서도 강력한', 즉 "두 세계의 장점을 모두 가진" 최적의 임베딩을 만들어 예측 성능을 극대화합니다.
# 시계열 이상탐지

## Prompts (Powered by Claude)

### Question)
```
시계열 데이터에서 Point Anomaly와 Contextual Anomaly의 차이점을 설명하고, 각각의 예시를 들어주세요.
```

### Answer)
시계열 이상탐지에서 Point Anomaly와 Contextual Anomaly는 이상치의 특성에 따라 구분됩니다.

**Point Anomaly (점 이상치)**
- 개별 데이터 포인트 자체가 전체 데이터셋의 정상 범위를 벗어나는 경우
- 전후 문맥과 무관하게 해당 시점의 값 자체가 비정상적
- 예시:
  - 센서 데이터에서 갑작스러운 스파이크 (예: 온도 센서가 순간적으로 200도 기록)
  - 네트워크 트래픽에서 평소 대비 100배 이상의 요청 발생
  - 주식 가격에서 flash crash로 인한 급격한 하락

**Contextual Anomaly (맥락 이상치)**
- 값 자체는 정상 범위 내이지만, 특정 맥락(시간, 계절, 패턴)에서 비정상적인 경우
- 시간적 순서나 주변 데이터와의 관계를 고려했을 때 이상
- 예시:
  - 여름철 난방 에너지 소비 증가 (값 자체는 정상이지만 계절을 고려하면 이상)
  - 주말 출근 시간대의 교통량 감소 (평일과 비교했을 때 비정상)
  - 야간 시간대의 사무실 전력 소비 급증

Contextual Anomaly 탐지가 더 어려운 이유는 시간적 패턴, 계절성, 트렌드 등을 함께 고려해야 하기 때문입니다.

---

### Question)
```
시계열 이상탐지 모델의 성능을 평가할 때 사용하는 주요 지표들(Precision, Recall, F1-Score, AUROC)에 대해 설명하고, 이상탐지에서 각 지표가 갖는 의미를 설명해주세요.
```

### Answer)
시계열 이상탐지에서 사용되는 주요 평가지표들은 다음과 같습니다.

**1. Precision (정밀도)**
- 정의: 모델이 이상으로 예측한 것 중 실제로 이상인 비율
- 공식: TP / (TP + FP)
- 의미: 잘못된 경보(False Alarm)를 얼마나 줄였는가
- 중요성: 실무에서 False Positive가 많으면 알람 피로도가 증가하여 실제 이상을 무시하게 됨

**2. Recall (재현율, 민감도)**
- 정의: 실제 이상 중 모델이 정확히 탐지한 비율
- 공식: TP / (TP + FN)
- 의미: 실제 이상치를 얼마나 놓치지 않고 찾아냈는가
- 중요성: 중요한 이상을 놓치면(False Negative) 심각한 문제로 이어질 수 있음

**3. F1-Score**
- 정의: Precision과 Recall의 조화평균
- 공식: 2 × (Precision × Recall) / (Precision + Recall)
- 의미: 정밀도와 재현율 간의 균형을 나타냄
- 중요성: 클래스 불균형이 심한 이상탐지 문제에서 전체적인 성능 평가에 유용

**4. AUROC (Area Under ROC Curve)**
- 정의: ROC 곡선 아래 면적 (TPR vs FPR 곡선)
- 범위: 0~1 (1에 가까울수록 좋음)
- 의미: 임계값(threshold)에 무관하게 모델의 전반적인 분류 능력 평가
- 중요성: 다양한 임계값에서의 성능을 종합적으로 평가 가능

**이상탐지에서의 고려사항**
- 일반적으로 정상 데이터가 이상 데이터보다 훨씬 많아 클래스 불균형 문제 발생
- 도메인에 따라 중요도가 다름:
  - 의료/금융: Recall 중시 (이상 놓치면 안됨)
  - 알람 시스템: Precision 중시 (잘못된 경보 최소화)
- F1-Score나 AUROC로 전체적인 균형 평가

---

### Question)
```
시계열 이상탐지의 대표적인 방법론인 Reconstruction 기반 방법과 예측 기반 방법의 차이점과 각각의 장단점을 설명해주세요.
```

### Answer)
시계열 이상탐지의 두 가지 주요 접근법은 다음과 같습니다.

## 1. Reconstruction 기반 방법

**핵심 아이디어**
- 정상 데이터의 패턴을 학습하여 입력을 재구성(reconstruction)
- 재구성 오차(reconstruction error)가 크면 이상으로 판단
- 정상 데이터는 잘 재구성되고, 이상 데이터는 재구성이 어렵다는 가정

**대표 모델**
- Autoencoder (AE)
- Variational Autoencoder (VAE)
- Generative Adversarial Networks (GAN)

**장점**
- 비지도 학습 가능 (정상 데이터만으로 학습)
- 다양한 유형의 이상을 탐지 가능
- 고차원 데이터에서도 효과적

**단점**
- 모델이 이상 패턴도 학습하면 재구성 오차가 작아져 탐지 실패 가능
- 최적의 임계값(threshold) 설정이 어려움
- 시간적 의존성을 충분히 활용하지 못할 수 있음

## 2. 예측 기반 방법

**핵심 아이디어**
- 과거 데이터를 기반으로 미래 값을 예측
- 예측 오차(prediction error)가 크면 이상으로 판단
- 정상 패턴은 예측 가능하지만 이상은 예측하기 어렵다는 가정

**대표 모델**
- LSTM (Long Short-Term Memory)
- GRU (Gated Recurrent Unit)
- Transformer 기반 모델
- ARIMA, Prophet (통계적 방법)

**장점**
- 시간적 의존성과 순차 패턴을 자연스럽게 모델링
- 미래 시점 예측으로 선제적 대응 가능
- 도메인 지식과 결합하기 용이

**단점**
- 긴 시퀀스에서 장기 의존성 학습이 어려울 수 있음
- 급격한 패턴 변화나 concept drift에 민감
- 학습 데이터의 패턴에 과적합될 위험

## 비교 및 선택 기준

| 특성 | Reconstruction 기반 | 예측 기반 |
|------|-------------------|----------|
| 학습 방식 | 입력 → 재구성 | 과거 → 미래 예측 |
| 시간 정보 활용 | 상대적으로 약함 | 강함 |
| 적용 사례 | 센서 이상, 패턴 변화 | 트렌드 이탈, 시계열 예측 |
| 계산 복잡도 | 중간 | 중간~높음 |

**하이브리드 접근법**
최근에는 두 방법을 결합한 하이브리드 모델들이 제안되고 있습니다:
- LSTM-Autoencoder: 순차 정보 학습 + 재구성
- Transformer with Reconstruction: 예측과 재구성 손실을 함께 사용
- Anomaly Transformer: 연관성(association) 불일치를 활용한 이상탐지

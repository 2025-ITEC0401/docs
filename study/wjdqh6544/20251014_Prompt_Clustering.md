## Prompts (Powered by Gemini 2.5 Pro)
### Question)
```
Forecasting λ©μ μΌλ΅ μ¶”μ¶ν• μ„λ² λ”©μ„ Clustering μ‘μ—…μ— μ‚¬μ©ν• κ±°μ•Ό.

μ„λ² λ”© λ²΅ν„°λ” 768μ°¨μ› μ •λ„μΈ μƒν™©μ—μ„, μ‘μ—… κ³Όμ •μ„ μ•λ ¤μ¤.

1. μ°¨μ› μ¶•μ† -> ν΄λ¬μ¤ν„°λ§ μ•κ³ λ¦¬μ¦ μ μ© -> μ‹κ°ν™”

2. ν΄λ¬μ¤ν„°λ§ μ•κ³ λ¦¬μ¦ μ μ© -> μ°¨μ› μ¶•μ† -> μ‹κ°ν™”
```
### Answer)
λ„¤, 768μ°¨μ›μ κ³ μ°¨μ› μ„λ² λ”© λ²΅ν„°λ¥Ό ν΄λ¬μ¤ν„°λ§ν•λ” λ‘ κ°€μ§€ μ ‘κ·Ό λ°©μ‹μ— λ€ν•΄ μ„¤λ…ν•΄ λ“λ¦¬κ² μµλ‹λ‹¤. κ° λ°©λ²•μ€ μ¥λ‹¨μ μ΄ μμΌλ©°, λ°μ΄ν„°μ νΉμ„±κ³Ό λ¶„μ„ λ©ν‘μ— λ”°λΌ μ„ νƒμ΄ λ‹¬λΌμ§ μ μμµλ‹λ‹¤.

1. μ°¨μ› μ¶•μ† β†’ ν΄λ¬μ¤ν„°λ§ β†’ μ‹κ°ν™”
μ΄ λ°©λ²•μ€ κ°€μ¥ μΌλ°μ μ΄κ³  κ¶μ¥λλ” μ ‘κ·Ό λ°©μ‹μ…λ‹λ‹¤. κ³ μ°¨μ›μ λ°μ΄ν„°λ¥Ό μ €μ°¨μ›μΌλ΅ μ••μ¶•ν•μ—¬ λ…Έμ΄μ¦λ¥Ό μ¤„μ΄κ³ , κ³„μ‚° ν¨μ¨μ„±μ„ λ†’μΈ ν›„ ν΄λ¬μ¤ν„°λ§μ„ μν–‰ν•©λ‹λ‹¤.

μ‘μ—… κ³Όμ •
μ°¨μ› μ¶•μ† (Dimensionality Reduction): 768μ°¨μ›μ μ„λ² λ”© λ²΅ν„°λ¥Ό PCA, t-SNE, UMAPκ³Ό κ°™μ€ μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν•μ—¬ 2μ°¨μ› λλ” 3μ°¨μ›μ μ €μ°¨μ› λ²΅ν„°λ΅ λ³€ν™ν•©λ‹λ‹¤.

PCA (Principal Component Analysis): λ°μ΄ν„°μ λ¶„μ‚°μ„ μµλ€ν• λ³΄μ΅΄ν•λ” μ¶•μ„ μ°Ύμ•„ μ°¨μ›μ„ μ¶•μ†ν•©λ‹λ‹¤. κ³„μ‚° μ†λ„κ°€ λΉ λ¥΄κ³  λ°μ΄ν„°μ μ „μ²΄μ μΈ κµ¬μ΅°λ¥Ό νμ•…ν•λ” λ° μ μ©ν•©λ‹λ‹¤.

t-SNE (t-Distributed Stochastic Neighbor Embedding): κ³ μ°¨μ›μ—μ„ κ°€κΉμ› λ λ°μ΄ν„° ν¬μΈνΈλ“¤μ΄ μ €μ°¨μ›μ—μ„λ„ κ°€κΉκ² μ μ§€λλ„λ΅ ν•λ” λ° μ¤‘μ μ„ λ‘΅λ‹λ‹¤. μ‹κ°ν™”μ— λ§¤μ° ν¨κ³Όμ μ΄μ§€λ§, κ³„μ‚° λΉ„μ©μ΄ λ†’κ³  λ€κ·λ¨ λ°μ΄ν„°μ…‹μ—λ” λ¶€μ ν•©ν•  μ μμµλ‹λ‹¤.

UMAP (Uniform Manifold Approximation and Projection): t-SNEμ™€ μ μ‚¬ν•κ² λ°μ΄ν„°μ μ§€μ—­μ  κµ¬μ΅°λ¥Ό λ³΄μ΅΄ν•λ©΄μ„λ„, μ „μ—­μ μΈ κµ¬μ΅°(global structure)κΉμ§€ λ” μ μ μ§€ν•κ³  κ³„μ‚° μ†λ„λ„ λΉ λ¥΄λ‹¤λ” μ¥μ μ΄ μμµλ‹λ‹¤.

ν΄λ¬μ¤ν„°λ§ μ•κ³ λ¦¬μ¦ μ μ© (Clustering): μ°¨μ› μ¶•μ†λ λ°μ΄ν„°μ— K-Means, DBSCAN, κ³„μΈµμ  ν΄λ¬μ¤ν„°λ§ λ“±μ μ•κ³ λ¦¬μ¦μ„ μ μ©ν•μ—¬ κµ°μ§‘μ„ ν•μ„±ν•©λ‹λ‹¤.

K-Means: κµ°μ§‘μ κ°μ(K)λ¥Ό λ―Έλ¦¬ μ§€μ •ν•΄μ•Ό ν•λ©°, κ³„μ‚°μ΄ λΉ λ¥΄κ³  κ°„λ‹¨ν•©λ‹λ‹¤. κµ°μ§‘μ΄ μ›ν•μ ν•νƒλ¥Ό λ¨ λ• μΆ‹μ€ μ„±λ¥μ„ λ³΄μ…λ‹λ‹¤.

DBSCAN: λ°€λ„ κΈ°λ° ν΄λ¬μ¤ν„°λ§μΌλ΅, λ³µμ΅ν• ν•νƒμ κµ°μ§‘μ„ μ μ°Ύμ•„λ‚΄κ³  λ…Έμ΄μ¦λ¥Ό κµ¬λ¶„ν•  μ μμµλ‹λ‹¤. κµ°μ§‘μ κ°μλ¥Ό λ―Έλ¦¬ μ •ν•  ν•„μ”κ°€ μ—†μµλ‹λ‹¤.

μ‹κ°ν™” (Visualization): 2D λλ” 3Dλ΅ μ°¨μ› μ¶•μ†λ κ²°κ³Όλ¥Ό μ‚°μ λ„(scatter plot)λ΅ μ‹κ°ν™”ν•κ³ , κ° λ°μ΄ν„° ν¬μΈνΈλ¥Ό ν΄λ¬μ¤ν„°λ§ κ²°κ³Όμ— λ”°λΌ λ‹¤λ¥Έ μƒ‰μƒμΌλ΅ ν‘μ‹ν•μ—¬ κµ°μ§‘μ λ¶„ν¬μ™€ ν•νƒλ¥Ό μ§κ΄€μ μΌλ΅ ν™•μΈν•©λ‹λ‹¤.

2. ν΄λ¬μ¤ν„°λ§ β†’ μ°¨μ› μ¶•μ† β†’ μ‹κ°ν™”
μ΄ λ°©λ²•μ€ μ›λ³Έ κ³ μ°¨μ› κ³µκ°„μ—μ„ μ§μ ‘ ν΄λ¬μ¤ν„°λ§μ„ μν–‰ν• ν›„, κ·Έ κ²°κ³Όλ¥Ό ν™•μΈν•κΈ° μ„ν•΄ μ‹κ°ν™” λ©μ μΌλ΅λ§ μ°¨μ› μ¶•μ†λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.

μ‘μ—… κ³Όμ •
ν΄λ¬μ¤ν„°λ§ μ•κ³ λ¦¬μ¦ μ μ© (Clustering): 768μ°¨μ›μ μ›λ³Έ μ„λ² λ”© λ²΅ν„°μ— μ§μ ‘ ν΄λ¬μ¤ν„°λ§ μ•κ³ λ¦¬μ¦μ„ μ μ©ν•©λ‹λ‹¤. μ΄λ• 'μ½”μ‚¬μΈ μ μ‚¬λ„'μ™€ κ°™μ΄ κ³ μ°¨μ› ν…μ¤νΈ λ°μ΄ν„°μ— μ ν•©ν• κ±°λ¦¬ μΈ΅μ • λ°©μ‹μ„ μ‚¬μ©ν•λ” κ²ƒμ΄ μ¤‘μ”ν•  μ μμµλ‹λ‹¤.

κ³ μ°¨μ› λ°μ΄ν„°μ—μ„λ” μ ν΄λ¦¬λ“ κ±°λ¦¬(Euclidean distance)κ°€ μ λ™μ‘ν•μ§€ μ•λ” κ²½μ°κ°€ λ§μ•„(μ°¨μ›μ μ €μ£Ό), κ±°λ¦¬ κΈ°λ° μ•κ³ λ¦¬μ¦(μ: K-Means)μ μ„±λ¥μ΄ μ €ν•λ  μ μμµλ‹λ‹¤.

μ°¨μ› μ¶•μ† (Dimensionality Reduction): ν΄λ¬μ¤ν„°λ§μ΄ μ™„λ£λ ν›„, κ° λ°μ΄ν„° ν¬μΈνΈμ— ν• λ‹Ήλ κµ°μ§‘ λ μ΄λΈ”(cluster label) μ •λ³΄λ¥Ό μ μ§€ν• μ±„λ΅ μ‹κ°ν™”λ¥Ό μ„ν•΄ μ°¨μ› μ¶•μ†λ¥Ό μ§„ν–‰ν•©λ‹λ‹¤.

μ‹κ°ν™” (Visualization): μ°¨μ› μ¶•μ†λ λ°μ΄ν„° ν¬μΈνΈλ¥Ό μ‹κ°ν™”ν•λ, 1λ² λ‹¨κ³„μ—μ„ κ²°μ •λ κµ°μ§‘λ³„λ΅ μƒ‰μƒμ„ λ‹¤λ¥΄κ² ν‘μ‹ν•©λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ κ³ μ°¨μ› κ³µκ°„μ—μ„ ν•μ„±λ κµ°μ§‘μ΄ μ €μ°¨μ› κ³µκ°„μ—μ„ μ–΄λ–»κ² ν‘ν„λλ”μ§€ ν™•μΈν•  μ μμµλ‹λ‹¤.

λ‘ λ°©λ²•μ λΉ„κµ λ° μ¶”μ²
νΉμ§•	1. μ°¨μ› μ¶•μ† β†’ ν΄λ¬μ¤ν„°λ§ (κ¶μ¥)	2. ν΄λ¬μ¤ν„°λ§ β†’ μ°¨μ› μ¶•μ†
μ¥μ 	μ°¨μ›μ μ €μ£Ό(curse of dimensionality) νν”Ό, κ³„μ‚° ν¨μ¨μ„± μ¦λ€, λ…Έμ΄μ¦ κ°μ†	μ›λ³Έ λ°μ΄ν„°μ μ •λ³΄λ¥Ό μ†μ‹¤ μ—†μ΄ ν΄λ¬μ¤ν„°λ§μ— λ¨λ‘ ν™μ© κ°€λ¥
λ‹¨μ 	μ°¨μ› μ¶•μ† κ³Όμ •μ—μ„ μ •λ³΄ μ†μ‹¤μ΄ λ°μƒν•μ—¬ ν΄λ¬μ¤ν„°λ§ μ„±λ¥μ— μν–¥μ„ μ¤„ μ μμ	μ°¨μ›μ μ €μ£Όλ΅ μΈν•΄ κ±°λ¦¬ κΈ°λ° ν΄λ¬μ¤ν„°λ§ μ•κ³ λ¦¬μ¦μ μ„±λ¥μ΄ μ €ν•λ  μ μμ
μ£Όμ” μ‚¬μ© λ©μ 	ν¨μ¨μ μ΄κ³  μ•μ •μ μΈ ν΄λ¬μ¤ν„°λ§ λ° μ‹κ°ν™”	μ›λ³Έ κ³µκ°„μ—μ„μ κµ°μ§‘ κµ¬μ΅°λ¥Ό μµλ€ν• ν™•μΈν•κ³  μ‹¶μ„ λ•
μ¶”μ² μ•κ³ λ¦¬μ¦ μ΅°ν•©	UMAP/PCA + K-Means/DBSCAN	K-Means (μ½”μ‚¬μΈ μ μ‚¬λ„ κΈ°λ°) β†’ t-SNE/UMAP (μ‹κ°ν™”μ©)

Sheetsλ΅ λ‚΄λ³΄λ‚΄κΈ°
κ²°λ΅ : μ–΄λ–¤ λ°©λ²•μ„ μ„ νƒν•΄μ•Ό ν• κΉ?
λ€λ¶€λ¶„μ κ²½μ° **μ²« λ²μ§Έ λ°©λ²•(μ°¨μ› μ¶•μ† β†’ ν΄λ¬μ¤ν„°λ§)**μ΄ λ” λ‚μ€ κ²°κ³Όλ¥Ό μ κ³µν•©λ‹λ‹¤. 768μ°¨μ›κ³Ό κ°™μ€ κ³ μ°¨μ› κ³µκ°„μ—μ„λ” 'μ°¨μ›μ μ €μ£Ό'λ΅ μΈν•΄ λ°μ΄ν„° ν¬μΈνΈ κ°„μ κ±°λ¦¬ κ³„μ‚°μ΄ μλ―Έλ¥Ό μƒκΈ° μ‰½κ³ , μ΄λ΅ μΈν•΄ ν΄λ¬μ¤ν„°λ§ μ•κ³ λ¦¬μ¦μ μ„±λ¥μ΄ ν¬κ² μ €ν•λ  μ μμµλ‹λ‹¤.

λ”°λΌμ„ UMAPμ΄λ‚ PCAλ¥Ό μ΄μ©ν•΄ λ°μ΄ν„°μ μ¤‘μ”ν• κµ¬μ΅°λ” μ μ§€ν•λ©΄μ„ μ°¨μ›μ„ λ¨Όμ € μ¤„μΈ ν›„, μ €μ°¨μ› κ³µκ°„μ—μ„ ν΄λ¬μ¤ν„°λ§μ„ μν–‰ν•λ” κ²ƒμ΄ λ…Έμ΄μ¦μ μν–¥μ„ μ¤„μ΄κ³  κ³„μ‚°μ μΌλ΅λ„ ν¨μ¨μ μ΄λ©° λ” μ•μ •μ μΈ κµ°μ§‘μ„ μ°Ύλ” λ° λ„μ›€μ΄ λ©λ‹λ‹¤.

λ§μ•½ μ°¨μ› μ¶•μ†λ΅ μΈν• μ •λ³΄ μ†μ‹¤μ΄ μ°λ ¤λλ‹¤λ©΄, λ‘ λ²μ§Έ λ°©λ²•μ„ μ‹λ„ν•΄λ³Ό μλ” μμ§€λ§, ν΄λ¬μ¤ν„°λ§ μ•κ³ λ¦¬μ¦κ³Ό κ±°λ¦¬ μΈ΅μ • λ°©μ‹μ„ μ‹ μ¤‘ν•κ² μ„ νƒν•΄μ•Ό ν•©λ‹λ‹¤.

----
### Question)
```
κ·Έλ¬λ©΄, μ°¨μ› μ¶•μ†λ¥Ό λ¨Όμ € μ§„ν–‰ν•κ³ , ν΄λ¬μ¤ν„°λ§ μ•κ³ λ¦¬μ¦μ„ μ μ©ν•΄ λ³Όκ².

μ°¨μ› μ¶•μ†λ” μ–΄λ–»κ² ν•μ§€? t-SNE λ¥Ό μ‚¬μ©ν•΄μ•Ό ν•  κ²ƒ κ°™μ•„.
```
### Answer)
λ„¤, μΆ‹μ€ μ„ νƒμ…λ‹λ‹¤! μ°¨μ› μ¶•μ†λ¥Ό λ¨Όμ € μ§„ν–‰ν•λ©΄ 'μ°¨μ›μ μ €μ£Ό'λ¥Ό ν”Όν•κ³ , μ‹κ°μ μΌλ΅ λ°μ΄ν„°λ¥Ό νƒμƒ‰ν•λ©° ν΄λ¬μ¤ν„°λ§μ λ°©ν–¥μ„ μ΅λ” λ° ν° λ„μ›€μ΄ λ©λ‹λ‹¤.

t-SNEλ¥Ό μ‚¬μ©ν• μ°¨μ› μ¶•μ† κ³Όμ •μ— λ€ν•΄ μ£Όμ” νλΌλ―Έν„°μ™€ μ‹¤μ  μ½”λ“ μμ‹λ¥Ό μ¤‘μ‹¬μΌλ΅ μμ„Έν μ•λ ¤λ“λ¦΄κ²μ”.

t-SNE (t-Distributed Stochastic Neighbor Embedding) λ€?
t-SNEλ” κ³ μ°¨μ› κ³µκ°„μ—μ„ μ„λ΅ κ°€κΉμ΄ λ°μ΄ν„° ν¬μΈνΈλ“¤μ΄ μ €μ°¨μ›(μ£Όλ΅ 2D λλ” 3D)μ—μ„λ„ κ°€κΉκ² μ μ§€λλ„λ΅ ν•λ” μ‹κ°ν™” μ „λ¬Έ μ°¨μ› μ¶•μ† κΈ°λ²•μ…λ‹λ‹¤. λ°μ΄ν„°μ λ³µμ΅ν• κµ¬μ΅°μ™€ κµ°μ§‘μ„ μ‹κ°μ μΌλ΅ νμ•…ν•λ” λ° λ§¤μ° ν¨κ³Όμ μ…λ‹λ‹¤.

t-SNE μ‚¬μ©λ²•: ν•µμ‹¬ νλΌλ―Έν„° νλ‹ν•κΈ°
t-SNEλ” λ‡ κ°€μ§€ μ¤‘μ”ν• νλΌλ―Έν„°λ¥Ό μ–΄λ–»κ² μ„¤μ •ν•λλƒμ— λ”°λΌ κ²°κ³Όκ°€ ν¬κ² λ‹¬λΌμ§€λ―€λ΅, κ° νλΌλ―Έν„°μ μλ―Έλ¥Ό μ΄ν•΄ν•λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤.

n_components: μ¶•μ†ν•  μ°¨μ›μ μλ¥Ό μλ―Έν•©λ‹λ‹¤. μ‹κ°ν™”κ°€ λ©μ μ΄λ―€λ΅ λ³΄ν†µ 2 (2D) λλ” 3 (3D)μΌλ΅ μ„¤μ •ν•©λ‹λ‹¤.

μ¶”μ²: n_components=2

perplexity: t-SNEμ—μ„ κ°€μ¥ μ¤‘μ”ν• νλΌλ―Έν„°μ…λ‹λ‹¤. κ° λ°μ΄ν„° ν¬μΈνΈκ°€ μ£Όλ³€μ λ‡ κ°μ μ΄μ›ƒμ„ κ³ λ ¤ν•  κ²ƒμΈμ§€λ¥Ό κ²°μ •ν•λ©°, λ°μ΄ν„°μ μ§€μ—­μ /μ „μ—­μ  κµ¬μ΅°λ¥Ό μ–΄λ–»κ² ν¬μ°©ν• μ§€ μ΅°μ ν•©λ‹λ‹¤.

λ‚®μ€ κ°’ (e.g., 5): λ°μ΄ν„°μ λ§¤μ° μ§€μ—­μ μΈ(local) κµ¬μ΅°μ— μ§‘μ¤‘ν•©λ‹λ‹¤.

λ†’μ€ κ°’ (e.g., 50): λ°μ΄ν„°μ μΆ€ λ” μ „μ—­μ μΈ(global) κµ¬μ΅°λ¥Ό κ³ λ ¤ν•©λ‹λ‹¤.

μ¶”μ²: λ³΄ν†µ 5μ—μ„ 50 μ‚¬μ΄μ κ°’μ„ μ‚¬μ©ν•λ©°, λ°μ΄ν„°μ…‹μ ν¬κΈ°μ— λ”°λΌ μ΅°μ ν•©λ‹λ‹¤. 30μ„ μ‹μ‘μ μΌλ΅ μ—¬λ¬ κ°’μ„ μ‹λ„ν•΄λ³΄λ” κ²ƒμ΄ μΆ‹μµλ‹λ‹¤.

learning_rate: μµμ ν™” κ³Όμ •μ—μ„ κ° λ°μ΄ν„° ν¬μΈνΈμ μ„μΉλ¥Ό μ–Όλ§λ‚ ν¬κ² μ΅°μ •ν• μ§€λ¥Ό κ²°μ •ν•λ” ν•™μµλ¥ μ…λ‹λ‹¤.

μ¶”μ²: scikit-learn μµμ‹  λ²„μ „μ—μ„λ” **'auto'**κ°€ κΈ°λ³Έκ°’μ΄λ©°, μλ™μΌλ΅ μµμ μ κ°’μ„ μ°Ύμ•„μ£Όλ―€λ΅ κ·Έλ€λ΅ μ‚¬μ©ν•λ” κ²ƒμ„ κ¶μ¥ν•©λ‹λ‹¤. (μ΄μ „ λ²„μ „μ—μ„λ” 10~1000 μ‚¬μ΄, λ³΄ν†µ 200μ΄ κΈ°λ³Έκ°’)

n_iter: μµμ ν™”λ¥Ό μ„ν• λ°λ³µ νμμ…λ‹λ‹¤. ν¬μΈνΈλ“¤μ΄ μ•μ •μ μΈ μ„μΉμ— μλ ΄ν•  λ•κΉμ§€ μ¶©λ¶„ν• νμλ¥Ό μ§€μ •ν•΄μ•Ό ν•©λ‹λ‹¤.

μ¶”μ²: μµμ† 1000 μ΄μƒμ„ κ¶μ¥ν•©λ‹λ‹¤. (n_iter < 250μ΄λ©΄ μ• λ©λ‹λ‹¤)

init: μ΄κΈ° ν¬μΈνΈ λ°°μΉλ¥Ό μ–΄λ–»κ² ν• μ§€ κ²°μ •ν•©λ‹λ‹¤. PCA κ²°κ³Όλ¥Ό μ‚¬μ©ν•λ©΄ λ” μ•μ •μ μ΄κ³  λΉ λ¥΄κ² μλ ΄ν•  μ μμµλ‹λ‹¤.

μ¶”μ²: 'pca' λ¥Ό μ‚¬μ©ν•λ©΄ μ΄κΈ° λ…Έμ΄μ¦λ¥Ό μ¤„μ΄κ³  μ¬ν„μ„± μλ” κ²°κ³Όλ¥Ό μ–»λ” λ° λ„μ›€μ΄ λ©λ‹λ‹¤.

π’΅ λ§¤μ° μ¤‘μ”ν• ν: PCA λ¨Όμ € μ μ©ν•κΈ°
768μ°¨μ›κ³Ό κ°™μ€ κ³ μ°¨μ› λ°μ΄ν„°μ— t-SNEλ¥Ό μ§μ ‘ μ μ©ν•λ©΄ λ…Έμ΄μ¦κ°€ λ§κ³  κ³„μ‚° μ‹κ°„μ΄ λ§¤μ° μ¤λ κ±Έλ¦΄ μ μμµλ‹λ‹¤. μΌλ°μ μΈ λ¨λ²” μ‚¬λ΅€λ” PCAλ¥Ό μ‚¬μ©ν•΄ λ¨Όμ € 50~100μ°¨μ› μ •λ„λ΅ 1μ°¨ μ¶•μ†λ¥Ό ν• λ’¤, κ·Έ κ²°κ³Όμ— t-SNEλ¥Ό μ μ©ν•λ” κ²ƒμ…λ‹λ‹¤.

μ¥μ :

λ…Έμ΄μ¦ κ°μ†: PCAκ°€ λ°μ΄ν„°μ μ£Όμ” λ¶„μ‚° λ°©ν–¥(μ¤‘μ”ν• μ •λ³΄)λ§ λ‚¨κ²¨ λ…Έμ΄μ¦λ¥Ό μ¤„μ—¬μ¤λ‹λ‹¤.

κ³„μ‚° μ‹κ°„ λ‹¨μ¶•: t-SNEμ κ³„μ‚° λ³µμ΅λ„λ¥Ό ν¬κ² μ¤„μ—¬μ¤λ‹λ‹¤.

Python μ½”λ“ μμ‹ (scikit-learn μ‚¬μ©)
μ•„λλ” 768μ°¨μ› μ„λ² λ”© λ²΅ν„°(embedding_vectors)κ°€ μλ‹¤κ³  κ°€μ •ν•κ³  t-SNEλ¥Ό μ μ©ν•λ” μ „μ²΄ κ³Όμ •μ…λ‹λ‹¤.

Python

import numpy as np
from sklearn.manifold import TSNE
from sklearn.decomposition import PCA
import matplotlib.pyplot as plt
import seaborn as sns

# 1. μƒν” λ°μ΄ν„° μƒμ„± (μ‹¤μ  768μ°¨μ› μ„λ² λ”© λ²΅ν„°λ΅ λ€μ²΄)
# μμ‹: 500κ°μ λ°μ΄ν„° ν¬μΈνΈ, κ° 768μ°¨μ›
embedding_vectors = np.random.rand(500, 768)

# 2. (κ°•λ ¥ μ¶”μ²) PCAλ¥Ό μ΄μ©ν• 1μ°¨ μ°¨μ› μ¶•μ†
print("Running PCA...")
# λ…Έμ΄μ¦ κ°μ† λ° μ†λ„ ν–¥μƒμ„ μ„ν•΄ 50μ°¨μ›μΌλ΅ μ¶•μ†
pca = PCA(n_components=50, random_state=42)
pca_result = pca.fit_transform(embedding_vectors)
print("PCA complete. Shape after PCA:", pca_result.shape)


# 3. t-SNE λ¨λΈ μƒμ„± λ° ν•™μµ
print("Running t-SNE...")
tsne = TSNE(
    n_components=2,      # 2Dλ΅ μ¶•μ†
    perplexity=30,       # μΌλ°μ μΈ μ¶”μ² κ°’
    learning_rate='auto',# μλ™μΌλ΅ ν•™μµλ¥  μ΅°μ 
    n_iter=1000,         # μ¶©λ¶„ν• λ°λ³µ νμ
    init='pca',          # PCA κΈ°λ° μ΄κΈ°ν™”
    random_state=42      # κ²°κ³Όλ¥Ό μ¬ν„ν•κΈ° μ„ν• μ‹λ“
)

# PCA κ²°κ³Όμ— t-SNE μ μ©
tsne_result = tsne.fit_transform(pca_result)
print("t-SNE complete. Shape after t-SNE:", tsne_result.shape)


# 4. κ²°κ³Ό μ‹κ°ν™”
plt.figure(figsize=(12, 8))
sns.scatterplot(
    x=tsne_result[:, 0],
    y=tsne_result[:, 1],
    palette="viridis", # λ‚μ¤‘μ— ν΄λ¬μ¤ν„°λ§ κ²°κ³Ό(label)λ¥Ό μ—¬κΈ°μ— λ„£μΌλ©΄ μƒ‰μƒμΌλ΅ κµ¬λ¶„λ¨
    legend="full"
)

plt.title('t-SNE visualization of 768D embeddings')
plt.xlabel('t-SNE dimension 1')
plt.ylabel('t-SNE dimension 2')
plt.grid(True)
plt.show()

μ΄μ  μ΄ μ½”λ“λ¥Ό μ‹¤ν–‰ν•λ©΄ μ–»κ² λλ” 2μ°¨μ› μ‚°μ λ„(tsne_result)λ¥Ό λ°”νƒ•μΌλ΅ λ‹¤μ λ‹¨κ³„μΈ ν΄λ¬μ¤ν„°λ§ μ•κ³ λ¦¬μ¦(μ: K-Means, DBSCAN)μ„ μ μ©ν•λ©΄ λ©λ‹λ‹¤. μ‹κ°μ μΌλ΅ κµ°μ§‘μ΄ μ ν•μ„±λμ—λ‹¤λ©΄, ν΄λ¬μ¤ν„°λ§λ„ μ„±κ³µμ μΌλ΅ μν–‰λ  κ°€λ¥μ„±μ΄ λ†’μµλ‹λ‹¤.

----
### Question)
```
μ°¨μ› μ¶•μ† νΉμ€ ν΄λ¬μ¤ν„°λ§ μ•κ³ λ¦¬μ¦μ—μ„, GPUλ¥Ό μ‚¬μ©ν•λ” λ¶€λ¶„μ΄ μλ‚?
```
### Answer)
λ„¤, λ‹Ήμ—°ν μμµλ‹λ‹¤. νΉν 768μ°¨μ›κ³Ό κ°™μ€ κ³ μ°¨μ› λ°μ΄ν„°λ¥Ό λ‹¤λ£° λ• GPUλ¥Ό μ‚¬μ©ν•λ©΄ κ³„μ‚° μ‹κ°„μ„ μμ‹­ λ°°μ—μ„ μλ°± λ°°κΉμ§€ λ‹¨μ¶•μ‹ν‚¬ μ μμ–΄ λ§¤μ° μ μ©ν•©λ‹λ‹¤.

ν•µμ‹¬μ€ NVIDIAμ RAPIDS μƒνƒκ³„, κ·Έμ¤‘μ—μ„λ„ cuML (CUDA Machine Learning Library) λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ…λ‹λ‹¤. cuMLμ€ scikit-learnκ³Ό APIκ°€ κ±°μ λ™μΌν•μ—¬ κΈ°μ΅΄ μ½”λ“μ—μ„ λ‡ μ¤„λ§ μμ •ν•λ©΄ λ°”λ΅ GPU κ°€μ†μ„ ν™μ©ν•  μ μμµλ‹λ‹¤.

1. GPU κ°€μ†μ΄ κ°€λ¥ν• μ•κ³ λ¦¬μ¦
κ±°μ λ¨λ“  μ£Όμ” μ°¨μ› μ¶•μ† λ° ν΄λ¬μ¤ν„°λ§ μ•κ³ λ¦¬μ¦μ΄ cuMLμ„ ν†µν•΄ GPU κ°€μ†μ„ μ§€μ›ν•©λ‹λ‹¤.

π’» μ°¨μ› μ¶•μ† (Dimensionality Reduction)
t-SNE: CPUλ΅ μ‹¤ν–‰ν•λ©΄ λ§¤μ° λλ¦° λ€ν‘μ μΈ μ•κ³ λ¦¬μ¦μ…λ‹λ‹¤. cuMLμ t-SNEλ” μ—„μ²­λ‚ μ†λ„ ν–¥μƒμ„ λ³΄μ—¬μ£Όλ―€λ΅, λ€κ·λ¨ λ°μ΄ν„°μ…‹μ—μ„λ” κ±°μ ν•„μμ μ…λ‹λ‹¤.

UMAP: t-SNEλ³΄λ‹¤ λΉ λ¥΄μ§€λ§ μ—­μ‹ κ³„μ‚°λ‰μ΄ λ§μµλ‹λ‹¤. cuMLμ„ μ‚¬μ©ν•λ©΄ UMAP λν• κ·Ήμ μΌλ΅ λΉ¨λΌμ§‘λ‹λ‹¤.

PCA: cuMLμ PCAλ” λ€κ·λ¨ ν–‰λ ¬ μ—°μ‚°μ„ GPUλ΅ μ²λ¦¬ν•μ—¬ λΉ λ¥΄κ² μν–‰ν•©λ‹λ‹¤.

π€ ν΄λ¬μ¤ν„°λ§ (Clustering)
DBSCAN: λ°€λ„ κΈ°λ° ν΄λ¬μ¤ν„°λ§μΌλ΅, λ°μ΄ν„°κ°€ λ§μ•„μ§€λ©΄ CPUμ—μ„ μƒλ‹Ήν• μ‹κ°„μ΄ κ±Έλ¦½λ‹λ‹¤. cuMLμ DBSCANμ€ GPUμ λ³‘λ ¬ μ²λ¦¬ λ¥λ ¥μ„ ν™μ©ν•΄ λ§¤μ° λΉ λ¥΄κ² λ™μ‘ν•©λ‹λ‹¤.

K-Means: κ° λ°μ΄ν„° ν¬μΈνΈμ™€ μ¤‘μ‹¬μ  κ°„μ κ±°λ¦¬λ¥Ό λ°λ³µμ μΌλ΅ κ³„μ‚°ν•λ” κ³Όμ •μ΄ GPU λ³‘λ ¬ μ²λ¦¬μ— λ§¤μ° μ ν•©ν•μ—¬ μ†λ„ ν–¥μƒ ν¨κ³Όκ°€ ν½λ‹λ‹¤.

κ³„μΈµμ  ν΄λ¬μ¤ν„°λ§ (Hierarchical Clustering): μ΄ μ—­μ‹ cuMLμ—μ„ μ§€μ›ν•μ—¬ λ€κ·λ¨ λ°μ΄ν„°μ—μ„λ„ λΉ λ¥΄κ² κµ°μ§‘μ„ ν•μ„±ν•  μ μμµλ‹λ‹¤.

2. μ½”λ“ μ μ© λ°©λ²•: scikit-learn vs cuML
APIκ°€ μ–Όλ§λ‚ μ μ‚¬ν•μ§€ μ½”λ“λ΅ μ§μ ‘ λΉ„κµν•΄ λ³΄λ©΄ μ‰½κ² μ΄ν•΄ν•  μ μμµλ‹λ‹¤.

t-SNE μμ‹
κΈ°μ΅΄ scikit-learn μ½”λ“ (CPU μ‚¬μ©)

Python

from sklearn.manifold import TSNE

# CPUλ¥Ό μ‚¬μ©ν•μ—¬ t-SNE μ‹¤ν–‰
tsne_cpu = TSNE(n_components=2, perplexity=30, random_state=42)
tsne_result_cpu = tsne_cpu.fit_transform(embedding_vectors)
cuML μ½”λ“ (GPU μ‚¬μ©)

Python

# λΌμ΄λΈλ¬λ¦¬ μ΄λ¦„λ§ cumlλ΅ λ³€κ²½
from cuml.manifold import TSNE 

# GPUλ¥Ό μ‚¬μ©ν•μ—¬ t-SNE μ‹¤ν–‰
# APIμ™€ νλΌλ―Έν„°κ°€ κ±°μ λ™μΌν•¨
tsne_gpu = TSNE(n_components=2, perplexity=30, random_state=42)
tsne_result_gpu = tsne_gpu.fit_transform(embedding_vectors)
DBSCAN μμ‹
κΈ°μ΅΄ scikit-learn μ½”λ“ (CPU μ‚¬μ©)

Python

from sklearn.cluster import DBSCAN

# CPUλ¥Ό μ‚¬μ©ν•μ—¬ DBSCAN μ‹¤ν–‰
dbscan_cpu = DBSCAN(eps=0.5, min_samples=5)
clusters_cpu = dbscan_cpu.fit_predict(tsne_result) 
cuML μ½”λ“ (GPU μ‚¬μ©)

Python

# λΌμ΄λΈλ¬λ¦¬ μ΄λ¦„λ§ cumlλ΅ λ³€κ²½
from cuml.cluster import DBSCAN

# GPUλ¥Ό μ‚¬μ©ν•μ—¬ DBSCAN μ‹¤ν–‰
dbscan_gpu = DBSCAN(eps=0.5, min_samples=5)
clusters_gpu = dbscan_gpu.fit_predict(tsne_result)
λ³΄μ‹λ‹¤μ‹ν”Ό import κµ¬λ¬Έλ§ λ°”κΎΈλ©΄ κΈ°μ΅΄μ μ›ν¬ν”λ΅μ°λ¥Ό κ·Έλ€λ΅ μ μ§€ν•λ©΄μ„ GPUμ κ°•λ ¥ν• μ„±λ¥μ„ ν™μ©ν•  μ μμµλ‹λ‹¤.

3. μ‚¬μ©μ„ μ„ν• μ¤€λΉ„ μ‚¬ν•­ β…
GPU κ°€μ†μ„ μ‚¬μ©ν•λ ¤λ©΄ λ‡ κ°€μ§€ μ‚¬μ „ μ¤€λΉ„κ°€ ν•„μ”ν•©λ‹λ‹¤.

NVIDIA GPU: λ‹Ήμ—°ν CUDA μ½”μ–΄λ¥Ό νƒ‘μ¬ν• NVIDIA κ·Έλν”½ μΉ΄λ“κ°€ ν•„μ”ν•©λ‹λ‹¤.

CUDA Toolkit: NVIDIA λ“λΌμ΄λ²„μ™€ CUDA Toolkitμ΄ μ„¤μΉλμ–΄ μμ–΄μ•Ό ν•©λ‹λ‹¤.

RAPIDS μ„¤μΉ: cuMLμ€ RAPIDSμ μΌλ¶€μ…λ‹λ‹¤. pipλ³΄λ‹¤λ” condaλ¥Ό μ‚¬μ©ν•μ—¬ μ„¤μΉν•λ” κ²ƒμ΄ μΆ…μ†μ„± λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ°μ— ν›¨μ”¬ μμ›”ν•©λ‹λ‹¤.

Condaλ¥Ό μ‚¬μ©ν• RAPIDS μ„¤μΉ λ…λ Ήμ–΄ μμ‹:

Bash

conda create -n rapids-23.10 -c rapidsai -c conda-forge -c nvidia \
    rapids=23.10 python=3.9 cudatoolkit=11.8
(λ²„μ „μ€ RAPIDS κ³µμ‹ λ¬Έμ„λ¥Ό μ°Έμ΅°ν•μ—¬ μ‹μ¤ν…μ— λ§κ² μ΅°μ •ν•΄μ•Ό ν•©λ‹λ‹¤.)

κ²°λ΅ 
768μ°¨μ›μ μ„λ² λ”© λ²΅ν„°μ™€ κ°™μ΄ ν¬κ³  λ³µμ΅ν• λ°μ΄ν„°λ¥Ό λ‹¤λ£° λ•, GPU κ°€μ†μ€ μ„ νƒμ΄ μ•„λ‹ ν•„μμ— κ°€κΉμµλ‹λ‹¤. νΉν λ°λ³µμ μΈ μ‹¤ν—κ³Ό νλΌλ―Έν„° νλ‹μ΄ ν•„μ”ν• λ¶„μ„ κ³Όμ •μ—μ„ cuMLμ„ μ‚¬μ©ν•λ©΄ μ‘μ—… μ‹κ°„μ„ νκΈ°μ μΌλ΅ μ¤„μ—¬ λ¶„μ„μ ν¨μ¨μ„±μ„ κ·Ήλ€ν™”ν•  μ μμµλ‹λ‹¤.

---
### Question)
```
κ·Έλ¬λ©΄, GPUλ¥Ό ν™μ©ν•μ—¬ μ°¨μ› μ¶•μ† λ° ν΄λ¬μ¤ν„°λ§ μ‘μ—…μ„ μν–‰ν•λ” μ½”λ“λ¥Ό μ•λ ¤μ¤.
```
### Answer)
λ„¤, GPU κ°€μ† λΌμ΄λΈλ¬λ¦¬μΈ cuMLμ„ μ‚¬μ©ν•μ—¬ μ°¨μ› μ¶•μ†μ™€ ν΄λ¬μ¤ν„°λ§μ„ μν–‰ν•λ” μ „μ²΄ κ³Όμ •μ„ μ½”λ“λ΅ λ³΄μ—¬λ“λ¦¬κ² μµλ‹λ‹¤.

μ΄ μ½”λ“λ” **PCA (1μ°¨ μ¶•μ†) β†’ t-SNE (2μ°¨ μ‹κ°ν™”μ© μ¶•μ†) β†’ DBSCAN (ν΄λ¬μ¤ν„°λ§)**μ κ¶μ¥ νμ΄ν”„λΌμΈμ„ λ”°λ¦…λ‹λ‹¤. scikit-learn λ€μ‹  cumlμ„ μ‚¬μ©ν•λ©°, λ°μ΄ν„°λ” GPU λ©”λ¨λ¦¬ μ„μ—μ„ ν¨μ¨μ μΌλ΅ μ²λ¦¬λ©λ‹λ‹¤.

μ‚¬μ „ μ¤€λΉ„
λ¨Όμ €, RAPIDS ν™κ²½μ΄ κµ¬μ¶•λμ–΄ μμ–΄μ•Ό ν•©λ‹λ‹¤. condaλ¥Ό μ‚¬μ©ν•μ—¬ RAPIDSλ¥Ό μ„¤μΉν•λ” κ²ƒμ΄ κ°€μ¥ μ•μ •μ μ…λ‹λ‹¤.

GPU ν™μ© μ°¨μ› μ¶•μ† λ° ν΄λ¬μ¤ν„°λ§ μ „μ²΄ μ½”λ“
Python

import numpy as np
import cupy as cp  # GPUμ—μ„ NumPyμ²λΌ μ‚¬μ©λλ” λΌμ΄λΈλ¬λ¦¬
import cudf      # GPUμ—μ„ Pandasμ²λΌ μ‚¬μ©λλ” λΌμ΄λΈλ¬λ¦¬
from cuml.manifold import TSNE
from cuml.decomposition import PCA
from cuml.cluster import DBSCAN
import matplotlib.pyplot as plt
import seaborn as sns

# --- 1. μƒν” λ°μ΄ν„° μƒμ„± ---
# μ‹¤μ  768μ°¨μ› μ„λ² λ”© λ²΅ν„°λ΅ μ΄ λ¶€λ¶„μ„ λ€μ²΄ν•μ„Έμ”.
# μμ‹: 5000κ°μ λ°μ΄ν„° ν¬μΈνΈ, κ° 768μ°¨μ›
print("Generating sample data on CPU...")
cpu_embedding_vectors = np.random.rand(5000, 768).astype(np.float32)

# NumPy λ°°μ—΄(CPU)μ„ CuPy λ°°μ—΄(GPU)λ΅ μ „μ†΅
print("Moving data from CPU to GPU...")
gpu_embedding_vectors = cp.asarray(cpu_embedding_vectors)
print(f"Data is now on GPU. Shape: {gpu_embedding_vectors.shape}")

# --- 2. 1μ°¨ μ°¨μ› μ¶•μ†: PCA (GPU μ‚¬μ©) ---
# 768μ°¨μ› -> 50μ°¨μ›
# κ³ μ°¨μ›μ—μ„ t-SNEλ¥Ό λ°”λ΅ μ μ©ν•κΈ° μ „, λ…Έμ΄μ¦λ¥Ό μ¤„μ΄κ³  μ†λ„λ¥Ό λ†’μ΄κΈ° μ„ν•¨
print("\nRunning PCA on GPU...")
pca_gpu = PCA(n_components=50)
pca_result_gpu = pca_gpu.fit_transform(gpu_embedding_vectors)
print(f"PCA complete. Shape after PCA: {pca_result_gpu.shape}")

# --- 3. 2μ°¨ μ°¨μ› μ¶•μ†: t-SNE (GPU μ‚¬μ©) ---
# 50μ°¨μ› -> 2μ°¨μ› (μ‹κ°ν™”λ¥Ό μ„ν•΄)
print("\nRunning t-SNE on GPU...")
tsne_gpu = TSNE(
    n_components=2,
    perplexity=30,
    # cuMLμ t-SNEλ” learning_rate_method='barnes-hut'κ°€ κΈ°λ³Έμ΄λ©° ν¨μ¨μ μ„
    method='barnes-hut', 
    random_state=42
)
tsne_result_gpu = tsne_gpu.fit_transform(pca_result_gpu)
print(f"t-SNE complete. Shape after t-SNE: {tsne_result_gpu.shape}")

# --- 4. ν΄λ¬μ¤ν„°λ§: DBSCAN (GPU μ‚¬μ©) ---
# 2D t-SNE κ²°κ³Όμ— ν΄λ¬μ¤ν„°λ§ μ μ©
print("\nRunning DBSCAN on GPU...")
# epsμ™€ min_samplesλ” λ°μ΄ν„° λ¶„ν¬λ¥Ό λ³΄κ³  μ΅°μ •ν•΄μ•Ό ν•λ” ν•μ΄νΌνλΌλ―Έν„°
dbscan_gpu = DBSCAN(eps=1.0, min_samples=5) 
# DBSCANμ€ 2D μ‹κ°ν™” κ²°κ³Όμ— μ μ©ν•μ—¬ μ§κ΄€μ μΈ κµ°μ§‘μ„ μ°Ύκ±°λ‚,
# PCA κ²°κ³Ό(50μ°¨μ›)μ— μ§μ ‘ μ μ©ν•μ—¬ λ” ν’λ¶€ν• μ •λ³΄λ΅ κµ°μ§‘μ„ μ°Ύμ„ μλ„ μμ
clusters_gpu = dbscan_gpu.fit_predict(tsne_result_gpu)
print("DBSCAN complete.")

# --- 5. κ²°κ³Ό μ‹κ°ν™” ---
# μ‹κ°ν™”λ¥Ό μ„ν•΄ GPU λ°μ΄ν„°(CuPy)λ¥Ό CPU(NumPy)λ΅ λ‹¤μ‹ κ°€μ Έμ΄
print("\nMoving results back to CPU for plotting...")
tsne_result_cpu = cp.asnumpy(tsne_result_gpu)
clusters_cpu = cp.asnumpy(clusters_gpu)

# κ³ μ ν• ν΄λ¬μ¤ν„° κ°μ ν™•μΈ (λ…Έμ΄μ¦λ” -1λ΅ ν‘μ‹λ¨)
n_clusters = len(set(clusters_cpu)) - (1 if -1 in clusters_cpu else 0)
print(f"Found {n_clusters} clusters.")

# cuDF DataFrameμ„ μ‚¬μ©ν•μ—¬ λ°μ΄ν„° κ²°ν•©
df_plot = cudf.DataFrame()
df_plot['tsne-2d-one'] = tsne_result_gpu[:, 0]
df_plot['tsne-2d-two'] = tsne_result_gpu[:, 1]
df_plot['cluster_label'] = clusters_gpu

# Pandasλ΅ λ³€ν™ν•μ—¬ Seabornμ—μ„ μ‹κ°ν™”
df_plot_pd = df_plot.to_pandas()

plt.figure(figsize=(14, 10))
sns.scatterplot(
    x="tsne-2d-one", y="tsne-2d-two",
    hue="cluster_label",
    palette=sns.color_palette("hsv", len(set(clusters_cpu))),
    data=df_plot_pd,
    legend="full",
    alpha=0.7
)

plt.title('GPU Accelerated t-SNE & DBSCAN Clustering')
plt.xlabel('t-SNE Dimension 1')
plt.ylabel('t-SNE Dimension 2')
plt.grid(True)
plt.show()

μ½”λ“ μ£Όμ” ν¬μΈνΈ μ§μ–΄λ³΄κΈ° π’΅
λ°μ΄ν„° μ΄λ™: λ¶„μ„ μ‹μ‘ μ‹μ μ— cp.asarray()λ¥Ό ν†µν•΄ λ°μ΄ν„°λ¥Ό CPUμ—μ„ GPUλ΅ ν• λ²λ§ μ®κΈ°κ³ , λ¨λ“  κ³„μ‚°(PCA, t-SNE, DBSCAN)μ€ GPU λ‚΄μ—μ„ μ²λ¦¬λ©λ‹λ‹¤. μ‹κ°ν™”λ¥Ό μ„ν•΄ λ§μ§€λ§‰μ— cp.asnumpy()λ΅ κ²°κ³Όλ¥Ό λ‹¤μ‹ CPUλ΅ κ°€μ Έμµλ‹λ‹¤.

λΌμ΄λΈλ¬λ¦¬ μ„ν¬νΈ: sklearn λ€μ‹  cumlμ„, numpy λ€μ‹  cupyλ¥Ό μ‚¬μ©ν•©λ‹λ‹¤. APIκ°€ κ±°μ κ°™μ•„ μ½”λ“ μ „ν™μ΄ λ§¤μ° μ‰½μµλ‹λ‹¤.

ν•μ΄νΌνλΌλ―Έν„°: DBSCANμ **eps**μ™€ min_samples κ°’μ€ λ°μ΄ν„°μ λ°€λ„μ— λ”°λΌ λ‹¬λΌμ§€λ―€λ΅, μ‹κ°ν™”λ κ²°κ³Όλ¥Ό λ³΄κ³  μ μ ν μ΅°μ •ν•΄μ•Ό ν•©λ‹λ‹¤. μ΄κΈ° t-SNE μ‚°μ λ„μ—μ„ μ λ“¤μ΄ μ–Όλ§λ‚ λ–¨μ–΄μ Έ μλ”μ§€ κ΄€μ°°ν•μ—¬ epsμ μ΄κΈ°κ°’μ„ μ •ν•  μ μμµλ‹λ‹¤.

ν΄λ¬μ¤ν„°λ§ λ€μƒ: μ„ μ½”λ“μ—μ„λ” μ‹κ°ν™”λ 2D t-SNE κ²°κ³Όμ— DBSCANμ„ μ μ©ν–μµλ‹λ‹¤. μ΄λ” μ‚¬λμ΄ κ²°κ³Όλ¥Ό μ§κ΄€μ μΌλ΅ μ΄ν•΄ν•κΈ° μΆ‹μ€ λ°©μ‹μ…λ‹λ‹¤. λ§μ•½ λ” λ§μ€ μ›λ³Έ λ°μ΄ν„°μ μ •λ³΄λ¥Ό ν™μ©ν•κ³  μ‹¶λ‹¤λ©΄, pca_result_gpu (50μ°¨μ›)μ— μ§μ ‘ DBSCANμ„ μ μ©ν•λ” κ²ƒλ„ μΆ‹μ€ μ „λµμ΄ λ  μ μμµλ‹λ‹¤.

----
### Question)
```
μ‚¬μ©ν•  GPUλ¥Ό μ„ νƒν•  μλ” μ—†λ‚?

κ·Έλ¦¬κ³ , μ‹κ°ν™”λ¥Ό μ„ν• μμΉ λ°μ΄ν„°λ¥Ό λ”°λ΅ μ €μ¥ν•΄μ•Ό ν•΄.
```
### Answer)
λ„¤, λ¬Όλ΅ μ…λ‹λ‹¤. νΉμ • GPUλ¥Ό μ§€μ •ν•΄μ„ μ‚¬μ©ν•λ” κ²ƒκ³Ό μ‹κ°ν™” λ°μ΄ν„°λ¥Ό νμΌλ΅ μ €μ¥ν•λ” κ²ƒ λ¨λ‘ κ°„λ‹¨ν•κ² μ²λ¦¬ν•  μ μμµλ‹λ‹¤.

1. μ‚¬μ©ν•  GPU μ„ νƒν•κΈ° (CUDA_VISIBLE_DEVICES)
μ—¬λ¬ κ°μ GPUκ°€ μ¥μ°©λ μ‹μ¤ν…μ—μ„ νΉμ • GPUλ§ μ‚¬μ©ν•λ„λ΅ μ§€μ •ν•  μ μμµλ‹λ‹¤. κ°€μ¥ μΌλ°μ μΈ λ°©λ²•μ€ νμ΄μ¬ μ¤ν¬λ¦½νΈ μ΄κΈ°μ— os λ¨λ“μ„ μ‚¬μ©ν•μ—¬ CUDA_VISIBLE_DEVICES ν™κ²½ λ³€μλ¥Ό μ„¤μ •ν•λ” κ²ƒμ…λ‹λ‹¤.

μ΄ μ½”λ“λ” cupyλ‚ cuml κ°™μ€ GPU λΌμ΄λΈλ¬λ¦¬λ¥Ό import ν•κΈ° μ „μ— λ°λ“μ‹ μ‹¤ν–‰λμ–΄μ•Ό ν•©λ‹λ‹¤.

os.environ["CUDA_VISIBLE_DEVICES"] = "0": μ²« λ²μ§Έ GPUλ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.

os.environ["CUDA_VISIBLE_DEVICES"] = "1": λ‘ λ²μ§Έ GPUλ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.

os.environ["CUDA_VISIBLE_DEVICES"] = "0,2": μ²« λ²μ§Έμ™€ μ„Έ λ²μ§Έ GPUλ¥Ό ν•¨κ» μ‚¬μ©ν•©λ‹λ‹¤.

μ½”λ“ μ μ© μμ‹
Python

import os

# π“Ά μ¤‘μ”: cuml, cupy, torch λ“± CUDA κ΄€λ ¨ λΌμ΄λΈλ¬λ¦¬ μ„ν¬νΈ μ „μ— μ‹¤ν–‰!
# μ‹μ¤ν…μ 2λ² GPU (μ„Έ λ²μ§Έ GPU)λ¥Ό μ‚¬μ©ν•λ„λ΅ μ§€μ •ν•©λ‹λ‹¤.
os.environ["CUDA_VISIBLE_DEVICES"] = "2" 

import numpy as np
import cupy as cp
from cuml.manifold import TSNE
# ... (μ΄ν• μ½”λ“λ” λ™μΌ)
2. μ‹κ°ν™” λ°μ΄ν„° νμΌλ΅ μ €μ¥ν•κΈ°
μ‹κ°ν™”μ— μ‚¬μ©λ 2μ°¨μ› μΆν‘μ™€ κ° μ μ ν΄λ¬μ¤ν„° λ μ΄λΈ” μ •λ³΄λ¥Ό νμΌλ΅ μ €μ¥ν•λ” κ²ƒμ€ λ§¤μ° κ°„λ‹¨ν•©λ‹λ‹¤. μ΄μ „ μ½”λ“μ—μ„ μƒμ„±ν• Pandas DataFrame (df_plot_pd)μ„ CSV νμΌλ΅ μ €μ¥ν•λ” κ²ƒμ΄ κ°€μ¥ μΌλ°μ μ΄κ³  νΈλ¦¬ν• λ°©λ²•μ…λ‹λ‹¤.

μ½”λ“ μ μ© μμ‹
μ•„λ μ½”λ“λ” μ΄μ „ μ½”λ“μ μ‹κ°ν™” λ‹¨κ³„μ— μ¶”κ°€ν•λ©΄ λ©λ‹λ‹¤.

Python

# ... (μ΄μ „ DBSCAN λ° μ‹κ°ν™” μ¤€λΉ„ μ½”λ“) ...

# Pandas DataFrameμΌλ΅ λ³€ν™ν•μ—¬ μ‹κ°ν™” μ¤€λΉ„
df_plot_pd = df_plot.to_pandas()

# --- β¨ λ°μ΄ν„° μ €μ¥ λ‹¨κ³„ μ¶”κ°€ ---
# μ‹κ°ν™”μ— μ‚¬μ©λ t-SNE μΆν‘μ™€ ν΄λ¬μ¤ν„°λ§ κ²°κ³Όλ¥Ό CSV νμΌλ΅ μ €μ¥ν•©λ‹λ‹¤.
output_filename = 'visualization_data.csv'
df_plot_pd.to_csv(output_filename, index=False) # index=Falseλ” λ¶ν•„μ”ν• ν–‰ λ²νΈλ¥Ό μ €μ¥ν•μ§€ μ•μ

print(f"\nμ‹κ°ν™” λ°μ΄ν„°κ°€ '{output_filename}' νμΌλ΅ μ €μ¥λμ—μµλ‹λ‹¤.")


# --- μ‹κ°ν™” λ‹¨κ³„ (κΈ°μ΅΄κ³Ό λ™μΌ) ---
plt.figure(figsize=(14, 10))
sns.scatterplot(
    x="tsne-2d-one", y="tsne-2d-two",
    hue="cluster_label",
    palette=sns.color_palette("hsv", len(set(clusters_cpu))),
    data=df_plot_pd,
    legend="full",
    alpha=0.7
)
plt.title('GPU Accelerated t-SNE & DBSCAN Clustering')
plt.show()
μ΄λ ‡κ² μ €μ¥λ visualization_data.csv νμΌμ€ λ‹¤μκ³Ό κ°™μ€ ν•νƒλ΅ κµ¬μ„±λ©λ‹λ‹¤. λ‚μ¤‘μ— μ΄ νμΌλ§ λ¶λ¬μ™€μ„ λ‹¤μ‹ μ‹κ°ν™”ν•κ±°λ‚ λ‹¤λ¥Έ λ¶„μ„μ— ν™μ©ν•  μ μμµλ‹λ‹¤.

tsne-2d-one	tsne-2d-two	cluster_label
15.432	-20.198	0
-5.876	33.451	1
16.001	-21.543	0
...	...	...
